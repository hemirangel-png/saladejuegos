<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversaciones con Sentido</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            min-height: 100vh;
            color: white;
            padding: 15px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* HEADER MINI */
        .header {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px;
            border-radius: 10px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: center;
        }

        .codigo-sala {
            background: rgba(39, 174, 96, 0.9);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 1px;
            margin-top: 5px;
            display: inline-block;
        }

        /* TARJETA DE PREGUNTA PRINCIPAL */
        .pregunta-container {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 12px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .topico-titulo {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
        }

        .pregunta-texto {
            font-size: 22px;
            font-weight: 600;
            line-height: 1.3;
        }

        /* LISTA HORIZONTAL DE PARTICIPANTES */
        .participantes-container {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 15px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .participantes-lista {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            max-height: 120px;
            overflow-y: auto;
        }

        .participante {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .participante.activo {
            background: #27ae60;
            color: white;
            font-weight: 600;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.5);
        }

        /* TURNO ACTUAL */
        .turno-actual {
            background: rgba(155, 89, 182, 0.3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .participante-actual {
            font-size: 18px;
            font-weight: 700;
            color: #9b59b6;
            margin-top: 5px;
        }

        /* BOTÃ“N SIGUIENTE */
        .btn-siguiente {
            background: #3498db;
            color: white;
            border: none;
            padding: 15px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
        }

        /* ANIMACIÃ“N */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulsando {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER MINI -->
        <div class="header">
            <div style="font-size: 18px; font-weight: 600;">Conversaciones</div>
            <div class="codigo-sala" id="codigoSala">ABC123</div>
        </div>

        <!-- TURNO ACTUAL -->
        <div class="turno-actual">
            <div>ðŸŽ¤ Turno de:</div>
            <div class="participante-actual" id="participanteActual">Cargando...</div>
        </div>

        <!-- TARJETA DE PREGUNTA PRINCIPAL -->
        <div class="pregunta-container">
            <div class="topico-titulo" id="topicoTitulo">FAMILIA</div>
            <div class="pregunta-texto" id="preguntaTexto">
                Cargando pregunta...
            </div>
        </div>

        <!-- LISTA HORIZONTAL DE PARTICIPANTES -->
        <div class="participantes-container">
            <div style="font-size: 14px; margin-bottom: 10px; text-align: center; color: rgba(255,255,255,0.8);">
                Participantes
            </div>
            <div class="participantes-lista" id="listaParticipantes">
                <!-- Los participantes se cargan dinÃ¡micamente -->
            </div>
        </div>

        <!-- BOTÃ“N SIGUIENTE -->
        <button class="btn-siguiente" onclick="siguienteTurno()">
            Siguiente Turno
        </button>
    </div>

    <script>
        // PARTICIPANTES REALES - se cargan desde la URL
        let participantes = [];
        let turnoActual = 1;

        // INICIALIZACIÃ“N
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const codigo = urlParams.get('codigo');
            const topico = urlParams.get('topico');
            const nombreParticipante = urlParams.get('participante');
            const esFacilitador = urlParams.get('creador') === 'true';
            const nombreReunion = urlParams.get('nombre');

            document.getElementById('codigoSala').textContent = codigo;
            document.getElementById('topicoTitulo').textContent = topico ? topico.toUpperCase() : 'FAMILIA';
            
            // CARGAR PARTICIPANTES REALES
            if (esFacilitador) {
                // El facilitador inicia la lista con su nombre
                participantes = [{ id: 1, nombre: nombreParticipante || 'Facilitador' }];
            } else {
                // Para participantes, mostramos lista de ejemplo (en app real vendrÃ­a de base de datos)
                participantes = [
                    { id: 1, nombre: nombreParticipante || 'TÃº' },
                    { id: 2, nombre: 'Ana' },
                    { id: 3, nombre: 'Carlos' },
                    { id: 4, nombre: 'MarÃ­a' }
                ];
            }
            
            cargarPregunta(topico);
            cargarParticipantes();
            actualizarInterfaz();
        });

        // CARGAR LISTA DE PARTICIPANTES
        function cargarParticipantes() {
            const lista = document.getElementById('listaParticipantes');
            lista.innerHTML = '';
            
            participantes.forEach(participante => {
                const span = document.createElement('span');
                span.className = 'participante';
                span.textContent = participante.nombre;
                span.id = `participante-${participante.id}`;
                lista.appendChild(span);
            });
        }

        // CARGAR PREGUNTA ALEATORIA
        function cargarPregunta(topico) {
            const preguntas = {
                'familia': [
                    "Â¿CuÃ¡l es tu recuerdo mÃ¡s valioso con tu familia?",
                    "Â¿QuÃ© tradiciÃ³n familiar te gusta mÃ¡s?",
                    "Â¿QuÃ© aprendiste de tus padres?",
                    "Â¿QuÃ© significa 'hogar' para ti?",
                    "Â¿QuÃ© momento familiar te ha marcado mÃ¡s?",
                    "Â¿QuÃ© valor familiar quieres conservar?",
                    "Â¿CÃ³mo ha influido tu familia en tu vida?"
                ],
                'espiritualidad': [
                    "Â¿QuÃ© te da paz interior?",
                    "Â¿CÃ³mo encuentras significado en la vida?",
                    "Â¿QuÃ© creencias te guÃ­an?",
                    "Â¿QuÃ© te conecta con algo mayor?",
                    "Â¿QuÃ© prÃ¡ctica espiritual te nutre?",
                    "Â¿CÃ³mo defines tu propÃ³sito?",
                    "Â¿QuÃ© experiencia te hizo sentir conectado?"
                ],
                'pareja': [
                    "Â¿QuÃ© valoras mÃ¡s en una relaciÃ³n?",
                    "Â¿CÃ³mo construyes confianza?",
                    "Â¿QuÃ© has aprendido del amor?",
                    "Â¿QuÃ© hace especial una relaciÃ³n?",
                    "Â¿CÃ³mo manejas los conflictos?",
                    "Â¿QuÃ© significa amar para ti?",
                    "Â¿QuÃ© cualidad buscas en una pareja?"
                ],
                'padre_hijos': [
                    "Â¿QuÃ© te gusta de ser padre/hijo?",
                    "Â¿QuÃ© valor quieres transmitir?",
                    "Â¿CÃ³mo es tu relaciÃ³n familiar?",
                    "Â¿QuÃ© consejo darÃ­as sobre familia?",
                    "Â¿QuÃ© momento con tus hijos/padres atesoras?",
                    "Â¿CÃ³mo equilibras los roles familiares?",
                    "Â¿QuÃ© has aprendido de tu familia?"
                ],
                'colegio': [
                    "Â¿QuÃ© maestro recuerdas con cariÃ±o?",
                    "Â¿QuÃ© aprendiste en la escuela que usas hoy?",
                    "Â¿QuÃ© experiencia escolar fue importante?",
                    "Â¿QuÃ© recuerdo escolar te hace feliz?",
                    "Â¿QuÃ© amistad escolar marcÃ³ tu vida?",
                    "Â¿QuÃ© lecciÃ³n del colegio aplicas aÃºn?",
                    "Â¿CÃ³mo fue tu primer dÃ­a de escuela?"
                ],
                'desarrollo_personal': [
                    "Â¿QuÃ© meta te emociona?",
                    "Â¿QuÃ© hÃ¡bito mejorÃ³ tu vida?",
                    "Â¿QuÃ© te gustarÃ­a aprender?",
                    "Â¿CÃ³mo superas desafÃ­os?",
                    "Â¿QuÃ© miedo has vencido?",
                    "Â¿QuÃ© te hace sentir realizado?",
                    "Â¿CÃ³mo te cuidas a ti mismo?"
                ]
            };

            const preguntasTopico = preguntas[topico] || preguntas.familia;
            const pregunta = preguntasTopico[Math.floor(Math.random() * preguntasTopico.length)];
            document.getElementById('preguntaTexto').textContent = pregunta;
        }

        // SIGUIENTE TURNO
        function siguienteTurno() {
            // Encontrar siguiente participante
            const indiceActual = participantes.findIndex(p => p.id === turnoActual);
            const siguienteIndice = (indiceActual + 1) % participantes.length;
            
            turnoActual = participantes[siguienteIndice].id;
            actualizarInterfaz();

            // Si es el primero, cambiar pregunta
            if (siguienteIndice === 0) {
                const urlParams = new URLSearchParams(window.location.search);
                const topico = urlParams.get('topico');
                cargarPregunta(topico);
            }
        }

        // ACTUALIZAR INTERFAZ
        function actualizarInterfaz() {
            const participanteActualElem = document.getElementById('participanteActual');
            
            // Quitar clase activa de todos
            document.querySelectorAll('.participante').forEach(p => {
                p.classList.remove('activo');
                p.classList.remove('pulsando');
            });
            
            // Agregar clase activa al participante actual
            const participanteActual = document.getElementById(`participante-${turnoActual}`);
            if (participanteActual) {
                participanteActual.classList.add('activo');
                participanteActual.classList.add('pulsando');
            }

            // Actualizar turno actual
            const participante = participantes.find(p => p.id === turnoActual);
            if (participante) {
                participanteActualElem.textContent = participante.nombre;
                participanteActualElem.classList.add('pulsando');
            }
        }

        // INICIAR CON EL PRIMER PARTICIPANTE
        setTimeout(() => {
            if (participantes.length > 0) {
                turnoActual = participantes[0].id;
                actualizarInterfaz();
            }
        }, 100);
    </script>
</body>
</html>