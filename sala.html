<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sala de Juego - Conversaciones con Sentido</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script>
        // âœ… TU CONFIGURACIÃ“N FIREBASE REAL
        const firebaseConfig = {
            apiKey: "AIzaSyAMLq68ijwQwmbfi1aq-yO0gK9TdCIstZ4",
            authDomain: "ccs-el-juego.firebaseapp.com",
            databaseURL: "https://ccs-el-juego-default-rtdb.firebaseio.com",
            projectId: "ccs-el-juego",
            storageBucket: "ccs-el-juego.firebasestorage.app",
            messagingSenderId: "1067594728486",
            appId: "1:1067594728486:web:a5510a9baba4d26e12d2e7"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        /* âœ… FONDO FIJO MEJORADO - SIN SALTOS EN MÃ“VIL */
        body {
            min-height: 100vh;
            color: white;
            padding: 15px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
        }
        
        /* âœ… NUEVO: Fondo usando pseudo-elemento en lugar de div separado */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: scroll; /* Importante para mÃ³viles */
            z-index: -1;
            /* Prevenir parpadeo en iOS */
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
            will-change: transform;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex: 1;
            position: relative; /* Para asegurar que estÃ© encima del fondo */
        }

        /* HEADER MEJORADO CON BOTONES - MODIFICADO */
        .header {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px;
            border-radius: 10px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            min-height: 70px; /* Reducido ya que no mostraremos el jugador */
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
        }

        .topico-titulo-header {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 6px; /* Ajustado */
        }

        .sala-info {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .codigo-sala-small {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 8px; /* Aumentado ligeramente */
            border-radius: 4px;
        }

        /* BOTONES HEADER AGRANDADOS - MODIFICADO */
        .botones-header {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 4px;
        }

        .btn-header {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 28px;
        }

        .btn-header:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .btn-header.copiado {
            background: rgba(39, 174, 96, 0.3);
            border-color: #27ae60;
        }

        /* TARJETA DE PREGUNTA PRINCIPAL */
        .pregunta-container {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 12px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .pregunta-texto {
            font-size: 22px;
            font-weight: 600;
            line-height: 1.4;
            padding: 10px;
        }

        .info-turno {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 10px;
            font-style: italic;
        }

        /* BOTONES PRINCIPALES */
        .botones-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn-principal {
            background: #D0342C;
            color: white;
            border: none;
            padding: 18px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-principal:hover {
            background: #B52A23;
            transform: translateY(-2px);
        }

        .btn-principal:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
        }

        /* MODIFICADO: BotÃ³n "Preguntas Aleatorias" */
        .btn-aleatorio {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px;
            font-size: 14px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-aleatorio:hover {
            background: #219653;
            transform: translateY(-2px);
        }

        .btn-aleatorio:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
        }

        /* BOTÃ“N VOLVER */
        .btn-volver-inicio {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px;
            font-size: 14px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-volver-inicio:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* PANEL DE JUGADORES (MÃS PEQUEÃ‘O Y ABAJO) */
        .jugadores-container {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px;
            border-radius: 10px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-top: auto;
        }

        .jugadores-titulo {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 8px;
            text-align: center;
            font-weight: 600;
        }

        .jugadores-lista {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .jugador {
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 10px;
            border-radius: 15px;
            border: 1px solid transparent;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
        }

        .jugador.turno-actual {
            background: rgba(46, 204, 113, 0.3);
            border-color: #27ae60;
            transform: scale(1.05);
        }

        .jugador.tu {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
        }

        .jugador.creador::before {
            content: "ğŸ‘‘";
            font-size: 10px;
            margin-right: 2px;
        }

        .jugador.turno-actual::after {
            content: "ğŸ¯";
            font-size: 10px;
            margin-left: 2px;
        }

        /* ANIMACIONES */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes gentlePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .dice-pulse {
            animation: gentlePulse 0.4s ease;
        }

        @keyframes highlight {
            0% { background: rgba(46, 204, 113, 0.5); }
            100% { background: rgba(46, 204, 113, 0.3); }
        }

        .highlight {
            animation: highlight 1s ease;
        }

        /* PIE DE PÃGINA */
        .footer {
            text-align: center;
            margin-top: 10px;
            padding: 10px;
        }

        .website-link {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 12px;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .website-link:hover {
            opacity: 1;
            text-decoration: underline;
        }

        /* âœ… RESPONSIVE PARA MÃ“VIL */
        @media (max-width: 768px) {
            body::before {
                background-attachment: scroll;
                height: 100vh;
                width: 100vw;
            }
            
            .pregunta-container {
                padding: 20px;
                min-height: 180px;
            }
            
            .pregunta-texto {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
                -webkit-overflow-scrolling: touch; /* Scroll suave en iOS */
            }
            
            .pregunta-container {
                padding: 15px;
                min-height: 160px;
            }
            
            .pregunta-texto {
                font-size: 18px;
                padding: 8px;
            }
            
            .btn-principal, .btn-aleatorio {
                padding: 16px;
            }
            
            body::before {
                /* Fuerza el hardware acceleration */
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }
        
        /* âœ… SOLUCIÃ“N ESPECÃFICA PARA iOS */
        @supports (-webkit-touch-callout: none) {
            body::before {
                height: -webkit-fill-available;
                min-height: -webkit-fill-available;
            }
            
            body {
                min-height: -webkit-fill-available;
            }
        }
    </style>
</head>
<body>
    <!-- âœ… ELIMINADO: <div class="background-fixed"></div> -->
    <!-- Ahora el fondo estÃ¡ en el pseudo-elemento ::before del body -->

    <div class="container">
        <!-- HEADER MEJORADO - SIMPLIFICADO -->
        <div class="header">
            <div class="topico-titulo-header" id="topicoTituloHeader">Cargando...</div>
            <div class="sala-info">
                <span>Sala:</span>
                <span class="codigo-sala-small" id="codigoSalaSmall">---</span>
            </div>
            <div class="botones-header">
                <button class="btn-header" onclick="copiarCodigoSala()" id="btnCopiarHeader">
                    ğŸ“‹ Copiar
                </button>
                <button class="btn-header" onclick="compartirSalaDesdeHeader()">
                    ğŸ“¤ Compartir
                </button>
            </div>
        </div>

        <!-- TARJETA DE PREGUNTA PRINCIPAL -->
        <div class="pregunta-container fade-in" id="preguntaContainer">
            <div class="pregunta-texto" id="preguntaTexto">
                Cargando pregunta...
            </div>
            <div class="info-turno" id="infoTurno">
                Conectando con los jugadores...
            </div>
        </div>

        <!-- BOTONES PRINCIPALES - MODIFICADO -->
        <div class="botones-container">
            <button class="btn-principal" id="btnSiguiente" onclick="siguienteTurno()" disabled>
                ğŸ”„ Siguiente Turno
            </button>
            
            <!-- MODIFICADO: BotÃ³n con nuevo texto -->
            <button class="btn-aleatorio" id="btnPreguntasAleatorias" onclick="lanzarDado()" disabled>
                ğŸ”€ Preguntas Aleatorias
            </button>
        </div>

        <!-- PANEL DE JUGADORES (ABAJO Y MÃS PEQUEÃ‘O) -->
        <div class="jugadores-container fade-in">
            <div class="jugadores-titulo">ğŸ® JUGADORES EN SALA</div>
            <div class="jugadores-lista" id="jugadoresLista">
                <div class="jugador">
                    <div>Cargando...</div>
                </div>
            </div>
        </div>

        <!-- BOTÃ“N SALIR -->
        <button class="btn-volver-inicio" onclick="salirDeSala()">
            â† Salir de la Sala
        </button>

        <!-- PIE DE PÃGINA -->
        <div class="footer">
            <a href="https://www.7preguntas.com" class="website-link" target="_blank">
                www.7preguntas.com
            </a>
        </div>
    </div>

    <script>
        // VARIABLES GLOBALES CON FIREBASE REAL
        let topicoActual = '';
        let codigoSala = '';
        let miNombre = '';
        let esCreador = false;
        let miJugadorId = '';
        let preguntas = [];
        let preguntaIndex = 0;
        let database = firebase.database();

        // BANCO DE PREGUNTAS COMPLETO (CON TODAS LAS 50 PREGUNTAS POR CATEGORÃA)
        const bancoPreguntas = {
            'que': [
                "Â¿QuÃ© te hace sentir realmente vivo?",
                "Â¿QuÃ© cambiarÃ­as de tu vida si el miedo no existiera?",
                "Â¿QuÃ© significa el Ã©xito para ti?",
                "Â¿QuÃ© te gustarÃ­a que la gente recordara de ti?",
                "Â¿QuÃ© harÃ­as diferente si supieras que nadie te juzgarÃ­a?",
                "Â¿QuÃ© te impide ser completamente feliz?",
                "Â¿QuÃ© aprendiste de tu mayor fracaso?",
                "Â¿QuÃ© te gustarÃ­a crear en este mundo?",
                "Â¿QuÃ© necesitas soltar para seguir adelante?",
                "Â¿QuÃ© te gustarÃ­a entender mejor sobre ti mismo?"
            ],
            'espiritualidad': [
                "Â¿Existe la condenaciÃ³n en tu creencia?",
                "Â¿CuÃ¡ndo fue la Ãºltima vez y por quÃ© te sentiste 'mÃ¡s espiritual'?",
                "Â¿CuÃ¡l es la creencia que mÃ¡s te mueve en la vida?",
                "Â¿QuÃ© ritos sueles realizar, acciones repetitivas relacionadas con tu creencia o religiÃ³n?",
                "Â¿Hablas de tus creencias? Â¿Por quÃ© sÃ­ o por quÃ© no?",
                "Â¿Crees que tu religiÃ³n tiene la verdad absoluta?",
                "DespuÃ©s de tu religiÃ³n o creencia, Â¿cuÃ¡l otra crees que se acerca mÃ¡s a la verdad?",
                "Â¿Hay algÃºn tipo de mÃºsica que te conecte mÃ¡s con lo espiritual?",
                "Si no fueras de la creencia o religiÃ³n que tienes ahora, Â¿hay alguna otra que te hubiera llamado la atenciÃ³n?",
                "Â¿QuÃ© aspecto de tu religiÃ³n no te gusta mucho?",
                "Â¿Alguna razÃ³n por la que te harÃ­as ateo o agnÃ³stico?",
                "Â¿QuÃ© no perdonarÃ­as?",
                "Â¿Dios ha respondido alguna vez tu oraciÃ³n?",
                "Â¿EstÃ¡s conforme con tu vida espiritual? Si respondes que no, explica por quÃ©.",
                "Â¿QuÃ© piensas en esta etapa de tu vida respecto de la muerte?",
                "Â¿Eres de las personas que les gusta la evoluciÃ³n de sus creencias, o prefieres quedarte seguro en una creencia fija y Ãºnica?",
                "Â¿Practicas alguna forma de oraciÃ³n, meditaciÃ³n o reflexiÃ³n? Â¿CÃ³mo te ayuda?",
                "Â¿DÃ³nde o en quÃ© situaciones te sientes mÃ¡s conectado espiritualmente?",
                "Â¿Hay algÃºn texto sagrado o enseÃ±anza espiritual que te inspire?",
                "Â¿CÃ³mo reconcilias el sufrimiento en el mundo con tus creencias espirituales?",
                "Â¿QuÃ© has aprendido de tradiciones espirituales diferentes a la tuya?",
                "Â¿Es posible respetar profundamente otras creencias mientras mantienes firmemente las tuyas?",
                "Â¿Has tenido alguna experiencia que considerarÃ­as espiritual o trascendente?",
                "Â¿Hay alguien que haya influido profundamente en tu camino espiritual?",
                "Â¿QuÃ© legado espiritual o valores te gustarÃ­a transmitir a las futuras generaciones?",
                "Â¿QuÃ© parte de tu espiritualidad es realmente tuya y quÃ© parte es solo lo que te programaron a creer?",
                "Si tu Dios te hablara ahora mismo, Â¿quÃ© crees que te dirÃ­a que estÃ¡s haciendo mal?",
                "Â¿Usas tu espiritualidad como excusa para no tomar responsabilidad sobre tu vida?",
                "Â¿CuÃ¡ntas veces has rezado por algo y luego no hiciste absolutamente nada para que sucediera?",
                "Â¿Tu fe te hace mejor persona o solo te hace sentir superior a los demÃ¡s?",
                "Â¿QuÃ© contradicciÃ³n entre lo que crees y lo que haces te niegas a ver?",
                "Si no hubiera castigo divino ni recompensa celestial, Â¿seguirÃ­as siendo 'buena persona'?",
                "Â¿QuÃ© pecado o falta repites constantemente mientras te perdonas a ti mismo una y otra vez?",
                "Â¿Tu comunidad religiosa te eleva espiritualmente o solo te da un club social para sentirte incluido?",
                "Â¿CuÃ¡nto de tu espiritualidad es bÃºsqueda genuina y cuÃ¡nto es miedo a estar equivocado?",
                "Â¿QuÃ© pregunta sobre tu fe te aterra hacerte porque podrÃ­a destruir todo tu sistema de creencias?",
                "Si tuvieras que defender tu fe ante alguien extremadamente inteligente y escÃ©ptico, Â¿podrÃ­as hacerlo sin recurrir a 'simplemente tienes que creer'?",
                "Â¿QuÃ© mandamiento, ley o enseÃ±anza de tu religiÃ³n ignoras convenientemente?",
                "Â¿EstÃ¡s dispuesto a cambiar de creencias si se te prueba que estÃ¡s equivocado, o ya cerraste tu mente?",
                "Â¿CuÃ¡nto tiempo dedicas realmente a tu espiritualidad versus cuÃ¡nto tiempo hablas de ella?",
                "Â¿Tu espiritualidad te da paz genuina o solo te genera culpa disfrazada de humildad?",
                "Si pudieras hacer una pregunta directa a tu concepto de divinidad y recibir respuesta clara, Â¿quÃ© preguntarÃ­as?",
                "Â¿QuÃ© milagro necesitarÃ­as presenciar para fortalecer tu fe? Â¿Y eso quÃ© dice sobre tu fe actual?",
                "Â¿Juzgas mÃ¡s a los 'pecadores' de lo que tu religiÃ³n te enseÃ±a a amar al prÃ³jimo?",
                "Â¿Tu espiritualidad te hace mÃ¡s libre o mÃ¡s esclavo de reglas que ni siquiera entiendes?",
                "Si tu hijo te dijera que no cree en nada de lo que tÃº crees, Â¿podrÃ­as amarlo igual o lo verÃ­as como fracaso tuyo?",
                "Â¿CuÃ¡ntas de tus decisiones importantes las tomas basÃ¡ndote en tu fe versus en tu conveniencia?",
                "Â¿EstÃ¡s usando a Dios como terapeuta gratuito en lugar de trabajar tus problemas reales?",
                "Â¿Tu vida refleja tus creencias espirituales o solo tu boca lo hace?",
                "Si murieras hoy y hubiera un juicio final, Â¿quÃ© crees que te reprocharÃ­an mÃ¡s: lo que hiciste o lo que no hiciste?"
            ],
            'familia': [
                "Describe tres cosas que crees que hacen a tu familia 'Ãºnica'.",
                "Â¿QuÃ© dirÃ­as que es una actividad que a todos los integrantes de tu familia les gusta realizar juntos?",
                "Â¿QuÃ© actividades o ritos crees que mantendrÃ¡s en tu propia familia que son parte de la actual?",
                "CaracterÃ­sticas de algÃºn familiar que te marcÃ³ positivamente.",
                "Si pudieras viajar a un momento en el pasado para cambiar algo, Â¿a quÃ© dÃ­a volverÃ­as?",
                "Â¿CuÃ¡l es tu recuerdo familiar favorito de cuando eras niÃ±o?",
                "Â¿QuÃ© tradiciÃ³n familiar esperas con mÃ¡s entusiasmo cada aÃ±o?",
                "Â¿Hay alguna historia familiar que te gustarÃ­a que se contara mÃ¡s seguido?",
                "Â¿CuÃ¡l fue el mejor viaje o vacaciones que hicimos juntos?",
                "Â¿QuÃ© comida te recuerda inmediatamente a nuestra familia?",
                "Â¿QuÃ© es algo que nadie en la familia sabe sobre ti?",
                "Â¿En quÃ© miembro de la familia te ves reflejado y por quÃ©?",
                "Â¿QuÃ© talento o habilidad de otro familiar admiras?",
                "Â¿QuÃ© es algo que nuestra familia hace mejor que otras?",
                "Â¿QuÃ© consejo le darÃ­as a alguien sobre cÃ³mo tener una familia unida?",
                "Â¿Por quÃ© miembro de la familia estÃ¡s mÃ¡s agradecido hoy y por quÃ©?",
                "Â¿CuÃ¡ndo te sentiste mÃ¡s apoyado por la familia?",
                "Â¿QuÃ© sacrificio has visto hacer a alguien de la familia por los demÃ¡s?",
                "Â¿QuÃ© aventura te gustarÃ­a que viviÃ©ramos juntos como familia?",
                "Â¿QuÃ© tradiciÃ³n nueva te gustarÃ­a que comenzÃ¡ramos?",
                "Â¿Hay algÃºn lugar del mundo que quisieras que visitÃ¡ramos juntos?",
                "Â¿CuÃ¡l ha sido el momento mÃ¡s difÃ­cil que hemos enfrentado como familia?",
                "Â¿Hay algo que como familia deberÃ­amos mejorar?",
                "Â¿QuÃ© obstÃ¡culo has superado gracias al apoyo familiar?",
                "Si nuestra familia fuera un equipo de superhÃ©roes, Â¿quÃ© poder tendrÃ­a cada uno?",
                "Â¿QuÃ© pelÃ­cula o serie representa mejor a nuestra familia?",
                "Â¿QuÃ© historia de nuestros abuelos o ancestros te parece mÃ¡s interesante?",
                "Â¿QuÃ© objeto familiar tiene mÃ¡s valor sentimental para ti?",
                "Â¿QuÃ© patrÃ³n tÃ³xico de tu familia estÃ¡s repitiendo sin darte cuenta?",
                "Â¿A quiÃ©n en la familia le debes una disculpa que nunca has dado?",
                "Â¿QuÃ© rol juegas en la familia que en realidad no quieres tener?",
                "Â¿CuÃ¡ntas veces has sacrificado tu felicidad solo para mantener la 'paz familiar'?",
                "Â¿QuÃ© secreto familiar todos conocen pero nadie habla?",
                "Â¿De quÃ© familiar te avergÃ¼enzas y por quÃ© no tienes los huevos para admitirlo?",
                "Â¿QuÃ© herida de tu infancia familiar sigues usando como excusa para no crecer?",
                "Â¿A quiÃ©n en tu familia has dejado de lado porque 'no tienes tiempo'?",
                "Â¿QuÃ© tradiciÃ³n familiar mantienes solo por obligaciÃ³n y no porque realmente la valores?",
                "Â¿CuÃ¡nto tiempo pasas con tu familia de calidad versus tiempo fÃ­sico sin conexiÃ³n real?",
                "Â¿QuÃ© le estÃ¡s enseÃ±ando a tus hijos con tu ejemplo que jurarÃ­as que no quieres que aprendan?",
                "Â¿QuÃ© miembro de la familia necesita tu ayuda ahora mismo pero finges no darte cuenta?",
                "Â¿EstÃ¡s mÃ¡s preocupado por la imagen de 'familia perfecta' que por la verdadera conexiÃ³n?",
                "Â¿QuÃ© conversaciÃ³n familiar importante sigues posponiendo porque eres cobarde?",
                "Â¿CuÃ¡ndo fue la Ãºltima vez que le dijiste 'te amo' a tu familia y realmente lo sentiste?",
                "Â¿QuÃ© aspecto de tu personalidad heredaste de tu familia que odias pero replicas?",
                "Si tu familia fuera brutalmente honesta contigo, Â¿quÃ© te dirÃ­an que te molesta de ti?",
                "Â¿CuÃ¡ntas reuniones familiares has perdido por trabajo o 'falta de tiempo' que nunca recuperarÃ¡s?",
                "Â¿EstÃ¡s criando a tus hijos o solo estÃ¡s replicando el manual de supervivencia que te dieron?",
                "Â¿QuÃ© familiar te hace daÃ±o constantemente pero sigues permitiÃ©ndolo 'porque es familia'?",
                "Â¿QuÃ© recuerdo familiar te persigue pero nunca has tenido el coraje de sanar?",
                "Si tu familia desapareciera maÃ±ana, Â¿quÃ© te arrepentirÃ­as de no haber dicho o hecho?"
            ],
            'amigos': [
                "Nombra tres cosas que eliminarÃ­as de tu amigo para que sea 'perfecto'.",
                "Actividad que mÃ¡s disfrutas con tus amigos.",
                "Â¿Te has enojado alguna vez con un amigo? Â¿Por quÃ©?",
                "Â¿QuÃ© crees que te perdonan tus amigos una y otra vez?",
                "Â¿Les has dicho alguna vez a alguno de tus amigos 'te lo dije'?",
                "Si tuvieras que dar tres caracterÃ­sticas que hace Ãºnico a tu amigo, Â¿cuÃ¡les serÃ­an?",
                "Â¿En quÃ© nunca han estado de acuerdo?",
                "Â¿QuÃ© hÃ¡bito traerÃ­as a tu vida de algÃºn amigo?",
                "Haz una historia de terror usando cuatro palabras.",
                "Haz una historia romÃ¡ntica usando cuatro palabras.",
                "Â¿QuÃ© superpoder poco convencional te gustarÃ­a tener?",
                "Â¿QuÃ© talento de alguno de tus amigos que estÃ¡n en este grupo te gustarÃ­a tener?",
                "Â¿CuÃ¡l es la cosa mÃ¡s vergonzosa que te ha pasado en pÃºblico?",
                "Â¿QuÃ© crush secreto tuviste que nadie supo?",
                "Â¿CuÃ¡l es tu guilty pleasure mÃ¡s extraÃ±o?",
                "Â¿QuÃ© mentira dijiste que se te saliÃ³ completamente de control?",
                "Â¿CuÃ¡l es el mensaje mÃ¡s cringe que has enviado a alguien?",
                "Â¿PreferirÃ­as poder leer mentes o ser invisible?",
                "Â¿Perder tu memoria o que todos tus amigos pierdan sus recuerdos de ti?",
                "Â¿Vivir sin mÃºsica o vivir sin pelÃ­culas/series por el resto de tu vida?",
                "Â¿Poder viajar al pasado o al futuro?",
                "Â¿Ser famoso pero odiado o desconocido pero amado?",
                "Cuenta la peor cita o salida que hayas tenido.",
                "Â¿CuÃ¡l es la mentira mÃ¡s grande que le dijiste a tus padres?",
                "Â¿CuÃ¡l fue tu momento mÃ¡s rebelde?",
                "Â¿Alguna vez te cacharon haciendo algo que no debÃ­as?",
                "Â¿CuÃ¡l es la travesura mÃ¡s loca que hiciste en la escuela?",
                "Â¿QuÃ© tendencia o moda actual no entiendes para nada?",
                "Â¿QuÃ© pelÃ­cula o serie sobrevalorada no te gustÃ³?",
                "Â¿En quÃ© momento te diste cuenta de que ya no eras un niÃ±o?",
                "Â¿CuÃ¡l es tu mayor miedo irracional?",
                "Â¿QuÃ© es algo que todos piensan de ti pero no es cierto?",
                "Â¿Con quÃ© personaje de ficciÃ³n te identificas mÃ¡s?",
                "Â¿En quÃ© apocalipsis crees que tendrÃ­as mÃ¡s chances de sobrevivir?",
                "Si fueras un villano, Â¿cuÃ¡l serÃ­a tu plan malvado?",
                "Â¿Alguna vez te has arrepentido de una amistad? Â¿Por quÃ©?",
                "Â¿QuÃ© es lo mÃ¡s raro que has googleado?",
                "Si pudieras borrar un recuerdo de tu vida, Â¿cuÃ¡l serÃ­a?",
                "Â¿A cuÃ¡l de tus amigos le has mentido mÃ¡s y sobre quÃ©?",
                "Â¿QuÃ© amigo te estÃ¡ usando y tÃº lo sabes pero no quieres admitirlo?",
                "Â¿De cuÃ¡l amistad te estÃ¡s aferrando solo porque tienen 'historia' pero ya no aporta nada?",
                "Â¿A quÃ© amigo has traicionado y nunca le pediste perdÃ³n?",
                "Â¿QuÃ© tan seguido finges estar de acuerdo con tus amigos solo para no quedar fuera del grupo?",
                "Â¿Has hablado mal de algÃºn amigo a sus espaldas? Â¿QuÃ© dijiste?",
                "Â¿CuÃ¡l de tus amigos te genera mÃ¡s envidia y por quÃ© no puedes alegrarte genuinamente por ellos?",
                "Â¿QuÃ© amigo necesita que le digas una verdad dura pero no tienes el valor?",
                "Â¿CuÃ¡ntos de tus 'amigos' realmente estarÃ­an ahÃ­ si perdieras todo maÃ±ana?",
                "Â¿Con cuÃ¡l de tus amigos eres completamente falso y por quÃ© sigues manteniendo esa amistad?",
                "Â¿QuÃ© tanto de tu personalidad cambias dependiendo del grupo de amigos con el que estÃ©s?",
                "Si tus amigos fueran brutalmente honestos contigo, Â¿quÃ© defecto tuyo seÃ±alarÃ­an primero?"
            ],
            'pareja': [
                "Describe tres caracterÃ­sticas de tu pareja que la hacen Ãºnica.",
                "Â¿CÃ³mo suelen resolver los conflictos?",
                "Â¿CuÃ¡l es la mayor enseÃ±anza que has aprendido de tu pareja?",
                "Nombra tres cosas que eliminarÃ­as de tu pareja para que sea 'perfecta'.",
                "Â¿En quÃ© crees que nunca se pondrÃ¡n de acuerdo?",
                "Â¿QuÃ© hÃ¡bito traerÃ­as a tu vida de tu pareja?",
                "Â¿QuÃ© pelÃ­cula para ver en pareja recomendarÃ­as?",
                "Â¿CuÃ¡les serÃ­an tu top tres de canciones romÃ¡nticas que te han acompaÃ±ado en la vida?",
                "Si pudieras viajar a un momento en el pasado para cambiar algo, Â¿a quÃ© dÃ­a volverÃ­as?",
                "Â¿QuÃ© fue lo primero que pensaste cuando me viste por primera vez?",
                "Â¿CuÃ¡l fue el momento exacto en que supiste que te gustaba?",
                "Â¿QuÃ© es algo sobre mÃ­ que te sorprendiÃ³ descubrir con el tiempo?",
                "Â¿CuÃ¡l es tu recuerdo favorito de nosotros juntos?",
                "Â¿QuÃ© lado mÃ­o te hace sentir mÃ¡s enamorado?",
                "Â¿CuÃ¡ndo te sientes mÃ¡s amado por mÃ­?",
                "Â¿Hay algo que quieras decirme pero te da miedo o vergÃ¼enza?",
                "Â¿CÃ³mo prefieres que te demuestre mi amor?",
                "Â¿En quÃ© momento te has sentido mÃ¡s vulnerable conmigo?",
                "Â¿QuÃ© necesitas de mÃ­ cuando estÃ¡s pasando por un mal momento?",
                "Â¿CÃ³mo te imaginas nuestra vida en cinco aÃ±os?",
                "Â¿QuÃ© aventura te gustarÃ­a que viviÃ©ramos juntos?",
                "Â¿Hay algÃºn sueÃ±o tuyo en el que quieras que yo participe?",
                "Â¿QuÃ© meta quisieras que logrÃ¡ramos como pareja?",
                "Â¿DÃ³nde te gustarÃ­a que viviÃ©ramos en el futuro?",
                "Â¿QuÃ© es algo que podrÃ­a hacer para que te sientas mÃ¡s apreciado?",
                "Â¿Hay algo que yo haga que te moleste pero no me lo has dicho?",
                "Â¿QuÃ© aspecto de nuestra relaciÃ³n crees que deberÃ­amos mejorar?",
                "Â¿CÃ³mo podemos comunicarnos mejor cuando discutimos?",
                "Â¿QuÃ© aprendiste de relaciones pasadas que aplicas con nosotros?",
                "Â¿CuÃ¡l ha sido nuestro momento mÃ¡s difÃ­cil y cÃ³mo crees que lo superamos?",
                "Â¿QuÃ© valores esperas que siempre compartamos?",
                "Â¿QuÃ© te hace sentir seguro en esta relaciÃ³n?",
                "Â¿QuÃ© actividad juntos te hace mÃ¡s feliz?",
                "Â¿QuÃ© canciÃ³n o pelÃ­cula representa nuestra historia?",
                "Â¿QuÃ© locura te gustarÃ­a que hiciÃ©ramos juntos algÃºn dÃ­a?",
                "Â¿QuÃ© tan seguido finges estar bien cuando en realidad no lo estÃ¡s?",
                "Â¿En quÃ© te estoy fallando que no me has dicho por miedo a herirme?",
                "Â¿CuÃ¡ntas veces has pensado en dejarlo todo pero te quedas por miedo o comodidad?",
                "Â¿QuÃ© aspecto de tu ex comparas constantemente conmigo aunque no lo admitas?",
                "Â¿EstÃ¡s realmente enamorado o solo tienes miedo de estar solo?",
                "Â¿QuÃ© fantasÃ­a sexual tienes que nunca te has atrevido a compartir?",
                "Â¿En quÃ© momento de nuestra relaciÃ³n sentiste que cometiste un error pero ya era tarde para echarte atrÃ¡s?",
                "Â¿QuÃ© sacrificio has hecho por esta relaciÃ³n del que te arrepientes en secreto?",
                "Â¿CuÃ¡nto de ti has perdido por intentar ser lo que tu pareja quiere?",
                "Â¿Hay alguien mÃ¡s a quien aÃºn piensas o extraÃ±as?",
                "Â¿QuÃ© conversaciÃ³n importante sigues evitando porque sabes que podrÃ­a terminar la relaciÃ³n?",
                "Â¿EstÃ¡s con la persona correcta en el momento equivocado o viceversa?",
                "Â¿QuÃ© parte de tu pareja toleras en lugar de realmente aceptar?",
                "Si tu pareja nunca cambia nada de lo que te molesta, Â¿podrÃ­as vivir asÃ­ para siempre?",
                "Â¿EstÃ¡s construyendo un futuro juntos o solo sobreviviendo el presente?"
            ],
            'padre_hijos': [
                "Â¿QuÃ© ha sido lo mÃ¡s difÃ­cil de ser padre o madre?",
                "Â¿QuÃ© momento de la vida de tus padres considerarÃ­as para hacer un libro?",
                "Â¿QuÃ© es lo que mÃ¡s te ha costado en esta etapa de tu vida, ya sea como padre/madre o como hijo?",
                "Â¿QuÃ© momento de la vida/historia familiar fue el mÃ¡s complejo para ti?",
                "Â¿Hay algÃºn tema que te cueste hablar con tus hijos?",
                "Â¿Hay algÃºn tema que te cueste hablar con tus padres?",
                "Â¿Hay algÃºn momento especial donde recuerdes haberte sentido muy orgulloso de tus hijos?",
                "Â¿Hay algÃºn momento especial donde recuerdes haberte sentido muy orgulloso de tus padres?",
                "Si pudieras viajar a un momento en el pasado para cambiar algo, Â¿a quÃ© dÃ­a volverÃ­as?",
                "Â¿QuÃ© crees que yo no entiendo sobre tu vida diaria?",
                "Â¿QuÃ© te gustarÃ­a que yo supiera sobre ti que nunca te he preguntado?",
                "Â¿Hay algo que hayas aprendido de mÃ­ recientemente?",
                "Â¿QuÃ© valor familiar es el mÃ¡s importante para ti y por quÃ©?",
                "Â¿QuÃ© te preocupa sobre el futuro?",
                "Â¿CuÃ¡l es un sueÃ±o que tienes pero que rara vez compartes?",
                "Â¿Hay algo que te dÃ© miedo admitir frente a mÃ­?",
                "Â¿QuÃ© te hace sentir mÃ¡s orgulloso en tu vida?",
                "Â¿CÃ³mo prefieres que te demuestre mi amor o apoyo?",
                "Â¿Hay algo que yo haga que te moleste pero no me lo has dicho?",
                "Â¿QuÃ© podrÃ­amos hacer juntos que nos ayudarÃ­a a estar mÃ¡s unidos?",
                "Â¿CuÃ¡ndo te sientes mÃ¡s escuchado por mÃ­?",
                "Â¿Hay algo que quisieras que hiciÃ©ramos diferente como familia?",
                "Si pudieras cambiar algo de cÃ³mo nos comunicamos, Â¿quÃ© serÃ­a?",
                "Â¿QuÃ© es algo que admiras de mÃ­?",
                "Â¿Hay algo de lo que deberÃ­a disculparme contigo?",
                "Â¿CÃ³mo te gustarÃ­a que manejÃ¡ramos los desacuerdos entre nosotros?",
                "Si pudieras pedirme una cosa, sin miedo a ser juzgado, Â¿quÃ© serÃ­a?",
                "Â¿En quÃ© te estoy fallando como padre/madre o como hijo/hija que no te atreves a decirme?",
                "Â¿CuÃ¡ntas veces has sentido que te decepcionÃ© pero te callaste?",
                "Â¿QuÃ© error mÃ­o como padre/madre te marcÃ³ mÃ¡s negativamente?",
                "Â¿De quÃ© tienes miedo que yo me entere sobre ti?",
                "Â¿CuÃ¡nto de tu vida me ocultas porque sabes que no lo entenderÃ­a o aprobarÃ­a?",
                "Padres: Â¿En quÃ© aspecto sientes que estÃ¡s repitiendo los errores de tus padres?",
                "Hijos: Â¿En quÃ© te pareces a tu padre/madre que mÃ¡s odias?",
                "Â¿QuÃ© sacrificio hice por ti que nunca has valorado realmente?",
                "Â¿CuÃ¡ntas oportunidades de conectar conmigo has desperdiciado por estar en el celular o 'ocupado'?",
                "Padres: Â¿CuÃ¡ndo fue la Ãºltima vez que realmente escuchaste a tu hijo sin pensar en tu respuesta?",
                "Hijos: Â¿CuÃ¡ndo fue la Ãºltima vez que les preguntaste a tus padres cÃ³mo estÃ¡n de verdad?",
                "Â¿QuÃ© conversaciÃ³n importante estamos posponiendo que ambos sabemos que debemos tener?",
                "Â¿QuÃ© tanto me conoces realmente versus la imagen que tienes de mÃ­?",
                "Padres: Â¿EstÃ¡s criando a tus hijos o solo controlÃ¡ndolos?",
                "Hijos: Â¿CuÃ¡ndo vas a dejar de culpar a tus padres y empezar a tomar responsabilidad de tu vida?",
                "Â¿QuÃ© parte de nuestra relaciÃ³n es genuina y quÃ© parte es solo obligaciÃ³n familiar?",
                "Â¿Te arrepientes de algo que me dijiste o hiciste pero tu orgullo no te deja disculparte?",
                "Â¿CuÃ¡nto tiempo mÃ¡s vamos a fingir que todo estÃ¡ bien cuando ambos sabemos que no es asÃ­?",
                "Padres: Â¿QuÃ© sueÃ±o tuyo sacrificaste por tus hijos del que te arrepientes?",
                "Hijos: Â¿QuÃ© presiÃ³n de tus padres estÃ¡s cumpliendo que en realidad no quieres?",
                "Â¿CuÃ¡ndo fue la Ãºltima vez que nos dijimos algo real y vulnerable sin mÃ¡scaras?",
                "Â¿QuÃ© necesitas perdonarme que aÃºn cargas en tu corazÃ³n?",
                "Si solo te quedaran 30 dÃ­as conmigo, Â¿quÃ© cambiarÃ­a en nuestra relaciÃ³n?"
            ],
            'colegio': [
                "Cuando estÃ¡s triste, Â¿quÃ© sueles hacer para que esa emociÃ³n sea menos invasiva?",
                "Â¿QuÃ© profesor o clase recuerdas con mayor alegrÃ­a y por quÃ©?",
                "Â¿QuÃ© has aprendido este aÃ±o que crees te ha servido mucho para la vida?",
                "Si pudieras tener una conversaciÃ³n de una hora con cualquier persona del mundo, Â¿quiÃ©n serÃ­a y quÃ© le preguntarÃ­as?",
                "Â¿QuÃ© habilidad o talento te gustarÃ­a desarrollar y por quÃ©?",
                "Â¿CuÃ¡l es una opiniÃ³n impopular que tienes y estÃ¡s dispuesto a defender?",
                "Â¿QuÃ© te hace sentir mÃ¡s orgulloso de ti mismo?",
                "Â¿CuÃ¡l ha sido el mejor consejo que te han dado y quiÃ©n te lo dio?",
                "Cuenta sobre un momento en que fallaste en algo pero aprendiste una lecciÃ³n valiosa.",
                "Â¿QuÃ© es algo que antes te daba miedo pero ahora ya no?",
                "Â¿CuÃ¡l ha sido el dÃ­a mÃ¡s memorable de tu vida hasta ahora?",
                "Â¿QuÃ© problema mundial te gustarÃ­a ayudar a resolver?",
                "Â¿Prefieres tener una vida predecible y segura o una llena de aventuras e incertidumbre?",
                "Â¿QuÃ© cualidad valoras mÃ¡s en un amigo?",
                "Â¿Crees que las redes sociales nos acercan o nos alejan como sociedad?",
                "Â¿Es mÃ¡s importante ser honesto siempre o ser amable siempre? Â¿Por quÃ©?",
                "Si pudieras cambiar una regla de tu escuela, Â¿cuÃ¡l serÃ­a y por quÃ©?",
                "Â¿Prefieres ser recordado por algo grande que hiciste o por cÃ³mo trataste a las personas?",
                "Â¿Es mejor arrepentirse de algo que hiciste o de algo que no hiciste?",
                "Si pudieras vivir en cualquier Ã©poca histÃ³rica por un aÃ±o, Â¿cuÃ¡l elegirÃ­as?",
                "Â¿QuÃ© libro, pelÃ­cula o serie ha cambiado tu forma de pensar sobre algo?",
                "Si tu vida fuera una pelÃ­cula, Â¿de quÃ© gÃ©nero serÃ­a?",
                "Â¿QuÃ© canciÃ³n describe mejor cÃ³mo te sientes en este momento de tu vida?",
                "Â¿Prefieres crear arte o consumirlo? Â¿Por quÃ©?",
                "Si pudieras inventar una materia escolar nueva, Â¿cuÃ¡l serÃ­a?",
                "Â¿QuÃ© superpoder elegirÃ­as si solo pudieras usarlo para ayudar a otros?",
                "Si pudieras cenar con tres personas, vivas o muertas, Â¿quiÃ©nes serÃ­an?",
                "Â¿En quÃ© eres completamente diferente a como eras hace tres aÃ±os?",
                "Si tuvieras que dar un consejo a alguien de 12 aÃ±os, Â¿cuÃ¡l serÃ­a?",
                "Â¿CuÃ¡ntas horas al dÃ­a desperdicias en el celular fingiendo que estÃ¡s 'descansando'?",
                "Â¿QuÃ© calificaciÃ³n refleja realmente tu esfuerzo y cuÃ¡l es puro cuento?",
                "Â¿A cuÃ¡ntos compaÃ±eros has juzgado sin conocerlos realmente?",
                "Â¿QuÃ© tanto de tu personalidad en el colegio es real y quÃ© tanto es actuaciÃ³n para encajar?",
                "Â¿Has permitido que molesten a alguien solo para no ser tÃº el blanco?",
                "Â¿CuÃ¡ntas oportunidades de aprender has perdido por hacerte el cool o la desinteresada?",
                "Â¿QuÃ© profesor te estÃ¡ diciendo la verdad que no quieres escuchar?",
                "Â¿EstÃ¡s estudiando para aprender o solo para aprobar y olvidar?",
                "Â¿A quiÃ©n le debes una disculpa en el colegio pero tu orgullo no te deja hacerlo?",
                "Â¿CuÃ¡nto potencial estÃ¡s desperdiciando por miedo al quÃ© dirÃ¡n?",
                "Â¿Has copiado en un examen? Â¿A quiÃ©n realmente engaÃ±aste?",
                "Â¿QuÃ© grupo o 'tribu' del colegio discriminas aunque no lo admitas?",
                "Â¿CuÃ¡nto de tu tiempo en el colegio inviertes en drama innecesario?",
                "Â¿QuÃ© compaÃ±ero estÃ¡ pasando por algo difÃ­cil y tÃº lo ignoras completamente?",
                "Â¿EstÃ¡s eligiendo tu futuro o solo siguiendo lo que esperan de ti?",
                "Â¿Has participado en chismes que daÃ±aron a alguien? Â¿CÃ³mo te sientes al respecto?",
                "Â¿QuÃ© oportunidad en el colegio no aprovechaste por flojera que ahora lamentas?",
                "Â¿CuÃ¡ntas clases has perdido mentalmente por estar en tu celular o en las nubes?",
                "Â¿QuÃ© versiÃ³n de ti quieres ser cuando termines el colegio: la que todos esperaban o la real?",
                "Â¿EstÃ¡s haciendo amigos reales o solo acumulando contactos superficiales?",
                "Si tu vida acadÃ©mica no cambia, Â¿dÃ³nde estarÃ¡s en cinco aÃ±os y te gusta esa respuesta?"
            ],
            'desarrollo_personal': [
                "Â¿QuÃ© tres caracterÃ­sticas tuyas son de exportaciÃ³n?",
                "Â¿QuÃ© aspecto de tu personalidad te ha ayudado positivamente en diferentes momentos de tu vida?",
                "Â¿QuÃ©, de lo que haces en la vida, es lo que mÃ¡s te apasiona y por quÃ©?",
                "Â¿Casualidad o causalidad?",
                "Â¿Eres una persona que reconoce sus errores?",
                "Tres personas que hayan dejado una huella en tu vida.",
                "Â¿QuÃ© tal te va con el manejo de las emociones?",
                "Â¿CÃ³mo suele percibirte la gente en una primera impresiÃ³n?",
                "Â¿CuÃ¡les serÃ­an los ingredientes que darÃ­as en una charla TED para que la gente sea feliz?",
                "Â¿QuÃ© pelÃ­cula recomendarÃ­as para aprender a vivir la vida?",
                "Â¿Vaso medio lleno o medio vacÃ­o?",
                "Si tuvieras dinero y tiempo para estudiar algo por puro placer, Â¿quÃ© serÃ­a?",
                "Libro a recomendar.",
                "Â¿Te consideras mÃ¡s racional o emocional?",
                "Termina la frase en primera persona: 'Hasta cuÃ¡ndo voy a...'",
                "Â¿QuiÃ©n eres realmente cuando nadie te estÃ¡ mirando?",
                "Â¿QuÃ© tres palabras te describen mejor y por quÃ©?",
                "Â¿CuÃ¡l es tu mayor fortaleza y cÃ³mo podrÃ­as usarla mÃ¡s?",
                "Â¿QuÃ© debilidad tuya te gustarÃ­a transformar en fortaleza?",
                "Â¿QuÃ© patrÃ³n negativo repites en tu vida sin darte cuenta?",
                "Â¿QuÃ© te hace sentir mÃ¡s vivo y lleno de energÃ­a?",
                "Si tuvieras seguridad econÃ³mica garantizada, Â¿a quÃ© dedicarÃ­as tu tiempo?",
                "Â¿CuÃ¡l crees que es tu propÃ³sito en la vida?",
                "Â¿QuÃ© legado te gustarÃ­a dejar en este mundo?",
                "Â¿CuÃ¡l es tu mayor miedo y cÃ³mo te limita?",
                "Â¿QuÃ© creencia limitante sobre ti mismo necesitas soltar?",
                "Â¿QuÃ© te impide ser la mejor versiÃ³n de ti mismo?",
                "Â¿QuÃ© experiencia dolorosa del pasado te ha enseÃ±ado mÃ¡s?",
                "Â¿A quiÃ©n necesitas perdonar (incluyÃ©ndote a ti mismo) para seguir adelante?",
                "Â¿QuÃ© hÃ¡bito diario te acerca mÃ¡s a tus metas?",
                "Â¿QuÃ© hÃ¡bito destructivo necesitas eliminar?",
                "Â¿CÃ³mo serÃ­a tu dÃ­a ideal de principio a fin?",
                "Â¿Hay alguna relaciÃ³n tÃ³xica que necesitas terminar o transformar?",
                "Â¿CÃ³mo te gustarÃ­a que las personas te recordaran?",
                "Â¿QuÃ© logro te harÃ­a sentir mÃ¡s orgulloso de ti mismo dentro de un aÃ±o?",
                "Â¿QuÃ© habilidad nueva cambiarÃ­a tu vida si la desarrollaras?",
                "Â¿CuÃ¡les son tus tres valores mÃ¡s importantes y los estÃ¡s viviendo?",
                "Â¿QuÃ© es innegociable para ti en la vida?",
                "Si hoy fuera tu Ãºltimo dÃ­a, Â¿quÃ© te arrepentirÃ­as de no haber hecho o dicho?",
                "Â¿QuÃ© versiÃ³n mejorada de ti estÃ¡s evitando convertirte en porque requiere trabajo real?",
                "Â¿CuÃ¡ntos libros de autoayuda has leÃ­do sin aplicar ni una sola lecciÃ³n?",
                "Â¿QuÃ© 'trauma' usas como excusa para no crecer que en realidad ya deberÃ­as haber superado?",
                "Â¿En quÃ© Ã¡rea de tu vida dices 'no tengo tiempo' cuando en realidad es 'no es prioridad'?",
                "Â¿CuÃ¡nto dinero has gastado en cursos, coaches o terapia que no has aplicado?",
                "Â¿QuÃ© promesa de aÃ±o nuevo llevas haciendo cinco aÃ±os seguidos sin cumplir?",
                "Â¿EstÃ¡s trabajando en ti mismo o solo coleccionando herramientas de desarrollo personal?",
                "Â¿QuÃ© tanto de tu 'crecimiento personal' es real y quÃ© tanto es contenido para redes sociales?",
                "Â¿CuÃ¡l es la verdad sobre ti que todos ven pero tÃº niegas ferozmente?",
                "Â¿EstÃ¡s esperando el momento perfecto para empezar o solo tienes miedo de fracasar?",
                "Â¿QuÃ© harÃ­as diferente si supieras que tienes exactamente un aÃ±o mÃ¡s de vida?"
            ],
            'doctor_house': [
                "De 1 a 10, Â¿quÃ© tanto te afecta la opiniÃ³n de los demÃ¡s?",
                "Debes elegir un libro, una pelÃ­cula y un Ã¡lbum para llevar al espacio.",
                "Â¿CÃ³mo te llevas con la crÃ­tica?",
                "Â¿QuÃ© le advertirÃ­as a tu yo de 15 aÃ±os?",
                "Â¿Un buen sueldo o un buen trabajo? (solo uno)",
                "Si pudieras elegir un nuevo trabajo, oficio o profesiÃ³n, Â¿cuÃ¡l serÃ­a?",
                "Â¿QuÃ© edad te gustarÃ­a tener para siempre?",
                "Si recibieras 10 millones de dÃ³lares de una herencia, Â¿quÃ© es lo mÃ¡s significativo que harÃ­as?",
                "Â¿El mejor ataque de risa del Ãºltimo tiempo?",
                "Has sido elegido senador, y te piden promover tres leyes nuevas, Â¿cuÃ¡les serÃ­an y por quÃ©?",
                "Cuando no has tenido un buen dÃ­a, Â¿quÃ© sueles hacer?",
                "Â¿QuÃ© sueÃ±o te queda por cumplir?",
                "Â¿QuÃ© personaje y de quÃ© pelÃ­cula serÃ­as o eres tÃº?",
                "Â¿Ãšltima serie o pelÃ­cula que te hizo llorar?",
                "Una caracterÃ­stica positiva de los participantes del grupo.",
                "Â¿QuÃ© harÃ­as en un aÃ±o sabÃ¡tico?",
                "Â¿QuÃ© pÃ©rdida recuerdas con especial tristeza?",
                "Â¿CuÃ¡les son las tres emociones que mÃ¡s sueles sentir?",
                "Â¿QuÃ© te gusta hacer cuando sabes que tendrÃ¡s tiempo libre?",
                "Â¿QuÃ© excusa te estÃ¡s creyendo ahora mismo que te mantiene exactamente donde no quieres estar?",
                "Si fueras brutalmente honesto, Â¿quÃ© problema en tu vida es completamente tu culpa?",
                "Â¿QuÃ© estÃ¡s fingiendo no saber sobre ti mismo?",
                "Â¿De quÃ© te quejas constantemente pero no haces absolutamente nada para cambiar?",
                "Â¿CuÃ¡l es la mentira mÃ¡s grande que te dices a ti mismo cada dÃ­a?",
                "Â¿En quÃ© Ã¡rea de tu vida te has conformado con ser mediocre?",
                "Â¿QuÃ© talento estÃ¡s desperdiciando por puro miedo o pereza?",
                "Â¿A quiÃ©n sigues permitiendo que te trate como basura y por quÃ©?",
                "Â¿QuÃ© relaciÃ³n te estÃ¡ drenando la vida y por quÃ© sigues ahÃ­?",
                "Â¿A quiÃ©n estÃ¡s usando como muleta emocional en lugar de resolver tus propios problemas?",
                "Â¿Con quiÃ©n estÃ¡s siendo falso y quÃ© te da tanto miedo de ser autÃ©ntico?",
                "Â¿QuÃ© no estÃ¡s haciendo porque te preocupa mÃ¡s lo que piensen los demÃ¡s que tu propia felicidad?",
                "Â¿De quÃ© tienes tanto miedo que prefieres una vida miserable pero 'segura'?",
                "Â¿QuÃ© oportunidad dejaste pasar y ahora te arrepientes como cobarde?",
                "Â¿QuÃ© harÃ­as maÃ±ana si supieras que nadie te va a juzgar?",
                "Â¿QuÃ© adicciÃ³n o mal hÃ¡bito estÃ¡s minimizando como si no fuera gran cosa?",
                "Â¿CuÃ¡nto tiempo mÃ¡s vas a culpar a tu infancia, tus padres o tus circunstancias?",
                "Â¿QuÃ© problema de salud estÃ¡s ignorando porque confrontarlo requerirÃ­a disciplina?",
                "Â¿En quÃ© te estÃ¡s saboteando justo cuando las cosas empiezan a mejorar?",
                "Â¿QuÃ© parte de tu sufrimiento actual disfrutas secretamente porque te da una identidad o atenciÃ³n?",
                "Â¿En quÃ© momento dejaste de luchar y decidiste ser una vÃ­ctima?",
                "Â¿CuÃ¡ntas veces mÃ¡s vas a 'empezar el lunes' antes de admitir que no quieres cambiar?",
                "Â¿QuÃ© necesitas escuchar que nadie tiene el valor de decirte?",
                "Â¿CuÃ¡l es la verdad incÃ³moda sobre ti que todos saben excepto tÃº?",
                "Â¿QuÃ© cambiarÃ­a en tu vida si dejaras de ser un cobarde por 30 dÃ­as?",
                "Â¿CuÃ¡ndo vas a dejar de leer preguntas de desarrollo personal y empezar a hacer algo de verdad?"
            ]
        };

        // NOMBRES DE TÃ“PICOS (AGREGAR DOCTOR HOUSE)
        const nombresTopicos = {
            'que': 'Â¿QuÃ©?',
            'espiritualidad': 'Espiritualidad',
            'familia': 'Familia', 
            'amigos': 'Amigos',
            'pareja': 'Pareja',
            'padre_hijos': 'Padre/Hijos',
            'colegio': 'Colegio',
            'desarrollo_personal': 'Desarrollo Personal',
            'doctor_house': 'Doctor House'
        };

        // âœ… CORREGIDO: INICIALIZAR SALA - FLUJO MEJORADO
        function inicializarSala() {
            const urlParams = new URLSearchParams(window.location.search);
            codigoSala = urlParams.get('sala') || '';
            
            console.log('ğŸ” DEBUG - ParÃ¡metros URL:', {sala: codigoSala});
            
            // Obtener datos de localStorage
            const salaData = JSON.parse(localStorage.getItem('salaActual') || '{}');
            console.log('ğŸ” DEBUG - localStorage:', salaData);
            
            miNombre = salaData.miNombre || 'Jugador';
            esCreador = salaData.esCreador || false;

            // Si no hay sala en URL, usar localStorage
            if (!codigoSala && salaData.codigo) {
                codigoSala = salaData.codigo;
                console.log('ğŸ”„ Usando cÃ³digo de localStorage:', codigoSala);
            }

            if (!codigoSala) {
                console.error('âŒ ERROR: No hay cÃ³digo de sala en URL ni localStorage');
                alert('Error: No se pudo conectar a la sala. Volviendo al inicio.');
                window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                return;
            }

            console.log('âœ… Conectando a sala:', codigoSala);

            // âœ… ACTUALIZAR HEADER INMEDIATAMENTE
            actualizarHeader();
            
            // âœ… CORREGIDO: OBTENER TÃ“PICO DESDE FIREBASE EN LUGAR DE URL
            obtenerTopicoDesdeFirebase();
            
            // Encontrar mi ID de jugador
            encontrarMiJugadorId();
        }

        // âœ… ACTUALIZAR HEADER SIMPLIFICADO
        function actualizarHeader() {
            const nombreTopico = nombresTopicos[topicoActual] || topicoActual;
            document.getElementById('topicoTituloHeader').textContent = nombreTopico;
            document.getElementById('codigoSalaSmall').textContent = codigoSala;
        }

        // âœ… NUEVA FUNCIÃ“N: OBTENER TÃ“PICO DESDE FIREBASE
        function obtenerTopicoDesdeFirebase() {
            database.ref('salas/' + codigoSala).once('value')
                .then(snapshot => {
                    const sala = snapshot.val();
                    
                    if (!sala) {
                        alert('La sala no existe');
                        window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                        return;
                    }

                    // âœ… USAR TÃ“PICO DESDE FIREBASE (LA FUENTE OFICIAL)
                    topicoActual = sala.topico || 'que';
                    console.log('âœ… TÃ³pico obtenido desde Firebase:', topicoActual);

                    // Actualizar interfaz
                    actualizarHeader();
                    cargarPreguntas();
                    
                    // ESCUCHAR CAMBIOS EN LA SALA EN TIEMPO REAL
                    escucharCambiosSala();
                    
                    // âœ… NUEVO: MOSTRAR UNA PREGUNTA INMEDIATA SI NO HAY NINGUNA EN FIREBASE
                    if (!sala.preguntaActual) {
                        mostrarPreguntaInicial();
                    }
                })
                .catch(error => {
                    console.error('Error obteniendo tÃ³pico:', error);
                    alert('Error al conectar con la sala. Volviendo al inicio.');
                    window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                });
        }

        // âœ… NUEVA FUNCIÃ“N: MOSTRAR PREGUNTA INICIAL
        function mostrarPreguntaInicial() {
            if (preguntas.length > 0) {
                const preguntaInicial = preguntas[0];
                preguntaIndex = 1; // Empezar desde la segunda pregunta
                
                // Mostrar en la interfaz
                document.getElementById('preguntaTexto').textContent = preguntaInicial;
                
                // Si somos el creador, guardar en Firebase
                if (esCreador) {
                    database.ref('salas/' + codigoSala).update({
                        preguntaActual: preguntaInicial
                    });
                }
            }
        }

        // ESCUCHAR CAMBIOS EN LA SALA EN TIEMPO REAL
        function escucharCambiosSala() {
            database.ref('salas/' + codigoSala).on('value', (snapshot) => {
                const sala = snapshot.val();
                
                if (!sala) {
                    alert('La sala ha sido eliminada');
                    window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                    return;
                }

                // âœ… ACTUALIZAR TÃ“PICO POR SI CAMBIA (AUNQUE NO DEBERÃA)
                if (sala.topico && sala.topico !== topicoActual) {
                    topicoActual = sala.topico;
                    actualizarHeader();
                    cargarPreguntas();
                }

                // âœ… CORREGIDO: ACTUALIZAR LISTA DE JUGADORES INCLUYENDO AL CREADOR
                actualizarListaJugadores(sala.jugadores);
                
                // âœ… SIEMPRE MOSTRAR PREGUNTA ACTUAL O UNA POR DEFECTO
                if (sala.preguntaActual) {
                    document.getElementById('preguntaTexto').textContent = sala.preguntaActual;
                } else if (preguntas.length > 0) {
                    // Si no hay pregunta en Firebase pero tenemos preguntas cargadas
                    mostrarPreguntaInicial();
                }

                // Actualizar estado del juego
                actualizarEstadoJuego(sala);
            });
        }

        // âœ… CORREGIDO: ACTUALIZAR LISTA DE JUGADORES INCLUYENDO AL CREADOR
        function actualizarListaJugadores(jugadores) {
            const jugadoresLista = document.getElementById('jugadoresLista');
            jugadoresLista.innerHTML = '';

            if (!jugadores) {
                jugadoresLista.innerHTML = '<div class="jugador">No hay jugadores en la sala</div>';
                return;
            }

            // Crear un array de jugadores para ordenarlos (creador primero)
            const jugadoresArray = Object.values(jugadores);
            const jugadoresIds = Object.keys(jugadores);
            
            // Ordenar: creador primero, luego los demÃ¡s
            jugadoresArray.sort((a, b) => {
                if (a.esCreador && !b.esCreador) return -1;
                if (!a.esCreador && b.esCreador) return 1;
                return 0;
            });

            // Mostrar cada jugador
            jugadoresArray.forEach((jugador, index) => {
                const jugadorId = jugadoresIds[index];
                const jugadorElement = document.createElement('div');
                jugadorElement.className = 'jugador';
                
                if (jugador.turno) {
                    jugadorElement.classList.add('turno-actual');
                }
                if (jugador.nombre === miNombre) {
                    jugadorElement.classList.add('tu');
                }
                if (jugador.esCreador) {
                    jugadorElement.classList.add('creador');
                }

                jugadorElement.textContent = jugador.nombre;
                jugadoresLista.appendChild(jugadorElement);
            });
        }

        // ACTUALIZAR ESTADO DEL JUEGO
        function actualizarEstadoJuego(sala) {
            const btnSiguiente = document.getElementById('btnSiguiente');
            const btnPreguntasAleatorias = document.getElementById('btnPreguntasAleatorias');
            const infoTurno = document.getElementById('infoTurno');

            // Verificar si es mi turno
            const esMiTurno = Object.keys(sala.jugadores || {}).some(jugadorId => 
                sala.jugadores[jugadorId].nombre === miNombre && sala.jugadores[jugadorId].turno
            );

            if (esMiTurno) {
                btnSiguiente.disabled = false;
                btnPreguntasAleatorias.disabled = false;
                infoTurno.textContent = "ğŸ¯ Â¡Es tu turno! Responde la pregunta.";
                document.getElementById('preguntaContainer').classList.add('highlight');
            } else {
                btnSiguiente.disabled = true;
                btnPreguntasAleatorias.disabled = true;
                
                // Encontrar quiÃ©n tiene el turno
                const jugadorTurno = Object.values(sala.jugadores || {}).find(j => j.turno);
                if (jugadorTurno) {
                    infoTurno.textContent = `â³ Turno de: ${jugadorTurno.nombre}`;
                } else if (sala.jugadores && Object.keys(sala.jugadores).length > 0) {
                    // Si no hay turno asignado pero hay jugadores
                    infoTurno.textContent = "ğŸ® Esperando que empiece el juego...";
                }
                
                document.getElementById('preguntaContainer').classList.remove('highlight');
            }

            // Si el creador puede forzar siguiente turno
            if (esCreador && !esMiTurno) {
                btnSiguiente.disabled = false;
                btnSiguiente.textContent = "ğŸ”„ Forzar Siguiente Turno";
            } else {
                btnSiguiente.textContent = "ğŸ”„ Siguiente Turno";
            }
        }

        // âœ… CORREGIDO: ENCONTRAR MI ID DE JUGADOR (MEJOR IMPLEMENTADO)
        function encontrarMiJugadorId() {
            database.ref('salas/' + codigoSala + '/jugadores').once('value')
                .then(snapshot => {
                    const jugadores = snapshot.val();
                    if (jugadores) {
                        Object.keys(jugadores).forEach(jugadorId => {
                            if (jugadores[jugadorId].nombre === miNombre) {
                                miJugadorId = jugadorId;
                                console.log('âœ… Mi ID de jugador encontrado:', miJugadorId);
                            }
                        });
                    }
                })
                .catch(error => {
                    console.error('Error encontrando ID de jugador:', error);
                });
        }

        // CARGAR PREGUNTAS
        function cargarPreguntas() {
            preguntas = bancoPreguntas[topicoActual] || bancoPreguntas.que;
            preguntas = mezclarArray([...preguntas]);
            console.log(`âœ… Cargadas ${preguntas.length} preguntas para: ${topicoActual}`);
            
            // âœ… NUEVO: Mostrar pregunta inmediata si ya cargamos la interfaz
            if (preguntas.length > 0 && document.getElementById('preguntaTexto').textContent === 'Cargando pregunta...') {
                const preguntaInicial = preguntas[0];
                preguntaIndex = 1;
                document.getElementById('preguntaTexto').textContent = preguntaInicial;
            }
        }

        // âœ… NUEVA FUNCIÃ“N: COPIAR CÃ“DIGO DESDE HEADER
        function copiarCodigoSala() {
            navigator.clipboard.writeText(codigoSala).then(() => {
                const btnCopiar = document.getElementById('btnCopiarHeader');
                const textoOriginal = btnCopiar.innerHTML;
                btnCopiar.innerHTML = 'âœ… Copiado!';
                btnCopiar.classList.add('copiado');
                
                setTimeout(() => {
                    btnCopiar.innerHTML = textoOriginal;
                    btnCopiar.classList.remove('copiado');
                }, 2000);
            }).catch(err => {
                alert('Error al copiar el cÃ³digo: ' + err);
            });
        }

        // âœ… CORREGIDO: COMPARTIR SALA DESDE HEADER - SOLO UN ENLACE
        function compartirSalaDesdeHeader() {
            const nombreTopico = nombresTopicos[topicoActual] || topicoActual;
            const texto = `Â¡Ãšnete a mi sala "${nombreTopico}" de Preguntas con Sentido! ğŸ®\n\nEntra directo aquÃ­: https://hemirangel-png.github.io/saladejuegos/unirse.html?codigo=${codigoSala}`;
            
            if (navigator.share) {
                // Compartir nativo (dispositivos mÃ³viles)
                navigator.share({
                    title: `Preguntas con Sentido - Sala ${nombreTopico}`,
                    text: texto,
                    url: `https://hemirangel-png.github.io/saladejuegos/unirse.html?codigo=${codigoSala}`
                }).catch(err => {
                    console.log('Error al compartir:', err);
                    copiarEnlaceParaCompartir(texto);
                });
            } else {
                // Fallback para escritorio
                copiarEnlaceParaCompartir(texto);
            }
        }

        function copiarEnlaceParaCompartir(texto) {
            navigator.clipboard.writeText(texto).then(() => {
                alert('âœ… Enlace copiado al portapapeles. Â¡PÃ©galo en tus redes sociales!');
            }).catch(err => {
                // Fallback final
                const textArea = document.createElement('textarea');
                textArea.value = texto;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('âœ… Enlace copiado al portapapeles. Â¡PÃ©galo en tus redes sociales!');
            });
        }

        // âœ… CORREGIDO: SIGUIENTE TURNO QUE ELIMINA JUGADORES FANTASMA
        function siguienteTurno() {
            database.ref('salas/' + codigoSala).once('value')
                .then(snapshot => {
                    const sala = snapshot.val();
                    const jugadores = Object.values(sala.jugadores || {});
                    const jugadoresIds = Object.keys(sala.jugadores || {});
                    
                    if (jugadores.length === 0) return;

                    // Encontrar jugador actual
                    const turnoActualIndex = jugadores.findIndex(j => j.turno);
                    let siguienteIndex = (turnoActualIndex + 1) % jugadores.length;

                    // Obtener siguiente pregunta
                    if (preguntaIndex >= preguntas.length) {
                        preguntaIndex = 0;
                        preguntas = mezclarArray([...preguntas]);
                    }
                    const siguientePregunta = preguntas[preguntaIndex];
                    preguntaIndex++;

                    // Actualizar turnos y pregunta
                    const updates = {};
                    jugadoresIds.forEach((jugadorId, index) => {
                        updates[`jugadores/${jugadorId}/turno`] = (index === siguienteIndex);
                    });
                    updates['preguntaActual'] = siguientePregunta;
                    updates['estado'] = 'jugando';

                    return database.ref('salas/' + codigoSala).update(updates);
                })
                .catch(error => {
                    console.error('Error en siguiente turno:', error);
                });
        }

        // LANZAR DADO - MODIFICADO: Cambiado nombre pero misma funciÃ³n
        function lanzarDado() {
            const btnAleatorio = document.getElementById('btnPreguntasAleatorias');
            btnAleatorio.classList.add('dice-pulse');
            
            // Mezclar preguntas
            preguntas = mezclarArray([...preguntas]);
            preguntaIndex = 0;
            
            // Obtener nueva pregunta aleatoria
            const nuevaPregunta = preguntas[0];
            preguntaIndex++;

            // Actualizar en Firebase
            database.ref('salas/' + codigoSala).update({
                preguntaActual: nuevaPregunta
            });

            setTimeout(() => {
                btnAleatorio.classList.remove('dice-pulse');
            }, 400);
        }

        // âœ… CORREGIDO: SALIR DE SALA - SIN AVISO, SALIDA DIRECTA
        function salirDeSala() {
            // Sin confirmaciÃ³n, salir directamente
            if (miJugadorId) {
                database.ref('salas/' + codigoSala).once('value')
                    .then(snapshot => {
                        const sala = snapshot.val();
                        const jugadores = sala.jugadores;
                        const jugadoresIds = Object.keys(jugadores);
                        
                        // âœ… SI SOY EL CREADOR Y HAY MÃS JUGADORES
                        if (esCreador && jugadoresIds.length > 1) {
                            // Encontrar siguiente jugador para transferir creaciÃ³n
                            const jugadoresArray = Object.values(jugadores);
                            const siguienteJugadorIndex = (jugadoresArray.findIndex(j => j.nombre === miNombre) + 1) % jugadoresArray.length;
                            const siguienteJugadorId = jugadoresIds[siguienteJugadorIndex];
                            
                            const updates = {};
                            updates[`jugadores/${siguienteJugadorId}/esCreador`] = true;
                            updates[`jugadores/${miJugadorId}`] = null; // âœ… ELIMINACIÃ“N COMPLETA
                            
                            // âœ… SI EL JUGADOR ELIMINADO TENÃA EL TURNO, PASAR AL SIGUIENTE
                            if (jugadores[miJugadorId].turno) {
                                const nuevoTurnoIndex = (siguienteJugadorIndex + 1) % jugadoresArray.length;
                                const nuevoTurnoId = jugadoresIds[nuevoTurnoIndex];
                                updates[`jugadores/${nuevoTurnoId}/turno`] = true;
                            }
                            
                            return database.ref('salas/' + codigoSala).update(updates);
                        } 
                        // âœ… SI SOY EL ÃšLTIMO JUGADOR
                        else if (jugadoresIds.length === 1) {
                            // Eliminar toda la sala
                            return database.ref('salas/' + codigoSala).remove();
                        }
                        // âœ… SI SOY JUGADOR NORMAL
                        else {
                            // âœ… ELIMINACIÃ“N COMPLETA
                            const updates = {};
                            updates[`jugadores/${miJugadorId}`] = null;
                            
                            // âœ… SI TENÃA EL TURNO, PASAR AL SIGUIENTE
                            if (jugadores[miJugadorId].turno) {
                                const jugadoresArray = Object.values(jugadores);
                                const miIndex = jugadoresArray.findIndex(j => j.nombre === miNombre);
                                const siguienteIndex = (miIndex + 1) % jugadoresArray.length;
                                const siguienteJugadorId = jugadoresIds[siguienteIndex];
                                updates[`jugadores/${siguienteJugadorId}/turno`] = true;
                            }
                            
                            return database.ref('salas/' + codigoSala).update(updates);
                        }
                    })
                    .then(() => {
                        localStorage.removeItem('salaActual');
                        window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                    })
                    .catch(error => {
                        console.error('Error saliendo de sala:', error);
                        // AÃºn asÃ­ redirigir al index
                        localStorage.removeItem('salaActual');
                        window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
                    });
            } else {
                localStorage.removeItem('salaActual');
                window.location.href = 'https://hemirangel-png.github.io/saladejuegos/index.html';
            }
        }

        // MEZCLAR ARRAY
        function mezclarArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // INICIALIZAR AL CARGAR
        document.addEventListener('DOMContentLoaded', inicializarSala);

        // TECLAS RÃPIDAS - MODIFICADO
        document.addEventListener('keydown', function(e) {
            const btnSiguiente = document.getElementById('btnSiguiente');
            const btnAleatorio = document.getElementById('btnPreguntasAleatorias');
            
            if ((e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') && !btnSiguiente.disabled) {
                siguienteTurno();
            } else if ((e.key === 'd' || e.key === 'D' || e.key === 'a' || e.key === 'A') && !btnAleatorio.disabled) {
                lanzarDado();
            } else if (e.key === 'Escape') {
                salirDeSala(); // Ahora tambiÃ©n sin confirmaciÃ³n con Escape
            }
        });

        // AL CERRAR LA PÃGINA
        window.addEventListener('beforeunload', function() {
            if (miJugadorId) {
                // âœ… ELIMINACIÃ“N COMPLETA AL CERRAR PÃGINA
                database.ref('salas/' + codigoSala + '/jugadores/' + miJugadorId).remove();
            }
        });
    </script>
</body>
</html>